{% extends "layout.html" %}

{% block title %}Accueil{% endblock %}

{% block content %}
    <h2>Bonjour, {{prof['prenom']}} {{prof['nom']}} !</h2>
    <div class="ui two columns grid">
        <div class="ui column">
            <h3>Vos cours</h3>
            <table class="ui celled table">
                <thead>
                    <tr>
                        <th>Sigle</th>
                        <th>Nom</th>
                        <th>Nombre de questions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for cours in courses %}
                        <tr>
                            <td>{{cours['sigle']}}</td>
                            <td><a href="/question/cours/{{cours['id']}}">{{cours['name']}}</a></td>
                            <td>{{cours['nbr_questions']}}</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <div class="ui column">
            <h3>Mes questions</h3>
            <div id="rate" class="ui large progress" data-percent="{{moyenne_reussite['average_reussite'] | round(2) }}">
                <div class="bar"></div>
                <div class="label">Taux de réussite moyen des questions: {{moyenne_reussite["average_reussite"] | round(2) }} %</div>
            </div>
            <br />
            <h4>Taux de réeussite par questions</h4>
            {% for cours in courses %}
                <h5>{{cours["sigle"]}}</h5>
                {% for taux_reussite_question in taux_reussite_questions_cours[cours["sigle"]] %}
                    <div id="good" class="ui small progress" data-percent="{{taux_reussite_question[1]}}">
                        <div class="bar"></div>
                        <div class="label">
                            {{taux_reussite_question[0]}} ({{taux_reussite_question[1]}} % sur {{taux_reussite_question[2]}} réponses)
                            <span class="{{taux_reussite_question[1]}}"></span>
                        </div>
                    </div>
                {% endfor %}
            {% endfor %}
        </div>
    </div>
{% endblock %}

{% block script %}
    {{super()}}
    <script>
        $(function() {
            $('.ui.progress').each(function() {
                var val = 'red';

                if($(this).data('percent') > 80) {
                    val = 'green';
                } else if($(this).data('percent') > 50) {
                    val = 'yellow';
                }

                $(this).addClass(val).progress();
            });
        });
    </script>
{% endblock %}
